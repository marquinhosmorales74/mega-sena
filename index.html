<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Mega-Sena – Gerador de Apostas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  padding: 20px;
}

.container {
  max-width: 420px;
  margin: auto;
  text-align: center;
}

h1 { color: #2e7d32; }

input {
  width: 100%;
  padding: 10px;
  margin: 10px 0;
}

.grid {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 8px;
}

.numero {
  padding: 12px 0;
  border-radius: 8px;
  background: #ddd;
  cursor: pointer;
  font-weight: bold;
}

.numero.sel {
  background: #2e7d32;
  color: white;
}

button {
  padding: 8px 12px;
  margin: 4px;
  border: none;
  border-radius: 6px;
  font-size: 13px;
  cursor: pointer;
}

.add { background: #1976d2; color: white; }
.auto { background: #6a1b9a; color: white; }
.pdf { background: #2e7d32; color: white; }
.clear { background: #b71c1c; color: white; }
.del { background: #c62828; color: white; }

.apostas {
  margin-top: 15px;
  text-align: left;
}

.aposta-item {
  background: white;
  padding: 8px;
  border-radius: 6px;
  margin-bottom: 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* ==== PRINT ==== */
@media print {
  body {
    background: white;
  }

  .container {
    max-width: 100%;
  }

  button, .grid {
    display: none;
  }

  .aposta-item {
    border: 1px solid #2e7d32;
  }
}
</style>
</head>

<body>

<div class="container">
  <h1>Mega-Sena</h1>

  <input id="nome" placeholder="Nome do Apostador">

  <div class="grid" id="grid"></div>

  <button class="add" onclick="adicionarManual()">Adicionar aposta manual</button>
  <button class="auto" onclick="apostaAutomatica()">Aposta automática</button>
  <button class="clear" onclick="limpar()">Limpar seleção</button>

  <div class="apostas" id="lista"></div>

  <button class="pdf" onclick="gerarPDF()">Gerar PDF</button>
</div>

<script>
const grid = document.getElementById("grid");
const lista = document.getElementById("lista");
const campoNome = document.getElementById("nome");

campoNome.value = localStorage.getItem("nome") || "";
campoNome.oninput = () => localStorage.setItem("nome", campoNome.value);

let selecionados = [];
let apostas = JSON.parse(localStorage.getItem("apostas")) || [];

// cria grade
for (let i = 1; i <= 60; i++) {
  const d = document.createElement("div");
  d.className = "numero";
  d.textContent = i.toString().padStart(2, "0");
  d.onclick = () => toggle(d, i);
  grid.appendChild(d);
}

function toggle(el, n) {
  if (selecionados.includes(n)) {
    selecionados = selecionados.filter(x => x !== n);
    el.classList.remove("sel");
  } else {
    if (selecionados.length >= 6) {
      alert("Máximo de 6 dezenas");
      return;
    }
    selecionados.push(n);
    el.classList.add("sel");
  }
}

function adicionarManual() {
  if (selecionados.length !== 6) {
    alert("Escolha exatamente 6 dezenas");
    return;
  }
  apostas.push([...selecionados].sort((a,b)=>a-b));
  salvar();
  limpar();
}

function apostaAutomatica() {
  const n = [];
  while (n.length < 6) {
    const r = Math.floor(Math.random()*60)+1;
    if (!n.includes(r)) n.push(r);
  }
  apostas.push(n.sort((a,b)=>a-b));
  salvar();
}

function excluirAposta(i) {
  apostas.splice(i,1);
  salvar();
}

function limpar() {
  selecionados=[];
  document.querySelectorAll(".numero").forEach(n=>n.classList.remove("sel"));
}

function salvar() {
  localStorage.setItem("apostas",JSON.stringify(apostas));
  render();
}

function render() {
  lista.innerHTML="";
  apostas.forEach((a,i)=>{
    lista.innerHTML+=`
      <div class="aposta-item">
        <div><b>Aposta ${i+1}:</b> ${a.join(" - ")}</div>
        <button class="del" onclick="excluirAposta(${i})">EXCLUIR</button>
      </div>`;
  });
}

function proximoSorteio() {
  const d = new Date();
  while (![3,6].includes(d.getDay())) d.setDate(d.getDate()+1);
  return d.toLocaleDateString("pt-BR");
}

function gerarPDF() {
  const titulo = document.querySelector("h1");
  const nome = campoNome.value || "-";

  const info = document.createElement("div");
  info.innerHTML = `
    <p><b>Apostador:</b> ${nome}</p>
    <p><b>Próximo sorteio:</b> ${proximoSorteio()}</p>
  `;

  titulo.after(info);
  window.print();
  info.remove();
}

render();
</script>

</body>
</html>
